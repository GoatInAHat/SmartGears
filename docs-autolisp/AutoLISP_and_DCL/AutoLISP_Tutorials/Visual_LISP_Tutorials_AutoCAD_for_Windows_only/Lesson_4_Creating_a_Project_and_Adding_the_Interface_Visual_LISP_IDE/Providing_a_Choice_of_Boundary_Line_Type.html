<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="concept" name="topic-type"/>
  <meta content="/view/OARX/2025/ENU/" name="helpsystempath"/>
  <meta content="OARX" name="product"/>
  <meta content="2025" name="release"/>
  <meta content="Developer" name="book"/>
  <meta content="AutoCAD-AutoLISP-Tutorials" name="component"/>
  <meta content="25/4/2024" name="created"/>
  <meta content="ACD=2025" name="applies-to"/>
  <meta content="ACAD_E=2025" name="applies-to"/>
  <meta content="AMECH_PP=2025" name="applies-to"/>
  <meta content="ARCHDESK=2025" name="applies-to"/>
  <meta content="BLDSYS=2025" name="applies-to"/>
  <meta content="CIV3D=2025" name="applies-to"/>
  <meta content="MAP=2025" name="applies-to"/>
  <meta content="PLNT3D=2025" name="applies-to"/>
  <meta content="PNID=2025" name="applies-to"/>
  <meta content="STRDET=2025" name="applies-to"/>
  <meta content="UTLDESN=2025" name="applies-to"/>
  <meta content="CSY, DEU, ESP, FRA, HUN, ITA, KOR, PLK, PTB, RUS, CHS, CHT" name="applies-to-languages"/>
  <meta content="TRIDION" name="generatedby"/>
  <meta content="disable" name="user-comments"/>
  <meta content="GUID-1A8D567B-168B-4272-BC70-8B50DC8B74CB" name="workflow-parent-id"/>
  <meta content="general" name="experiencelevel"/>
  <meta content="programmer" name="audience"/>
  <meta content="02/12/2019" name="modified"/>
  <meta content="autolisp" name="topic-subtype"/>
  <meta content="GUID-D377C55C-466C-44D1-B049-6E714EEDA327" name="topicid"/>
  <meta content="ENU" name="language"/>
  <title>
   Providing a Choice of Boundary Line Type
  </title>
  <link href="../../../../_assets/client-28da4093.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327">
  <div class="head">
   <div class="head-block">
    <div class="button-info">
     <span id="infoline">
     </span>
    </div>
    <div class="ancestry">
    </div>
    <div class="head-text">
     <h1>
      Providing a Choice of Boundary Line Type
     </h1>
    </div>
   </div>
  </div>
  <div class="body conbody">
   <div class="section" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__GUID-172A243A-EAB0-4440-8C26-D33A9FAD7DDB">
    <p class="p" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__WSFACF1429558A55DE1929BBDFEF458CE1C-7738">
     One requirement specified for the garden path application was to allow users to draw the boundary outline as either a lightweight polyline or an old-style polyline. The first version of
     <samp class="ph codeph" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__GUID-EE12D641-EB19-4DD6-9286-9713F2992853">
      gp:drawOutline
     </samp>
     you wrote always used a lightweight polyline to draw the boundary. Now that the dialog box interface is ready to go, you can build in the option for drawing an old-style polyline as well. To accomplish this,
     <samp class="ph codeph" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__GUID-76537CDB-D040-4A9E-9200-765C880C2114">
      gp:drawOutline
     </samp>
     must determine what kind of polyline to draw, and then it must draw it.
    </p>
    <p class="p" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__WSFACF1429558A55DE1929BBDFEF458CE1C-7737">
     The necessary changes to
     <samp class="ph codeph" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__GUID-68D5DA8B-5063-44D2-B7F5-BA29A8C8478A">
      gp:drawOutline
     </samp>
     are included in the following code fragment. Make the modification from the
     <em class="ph i" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__GUID-FF42F71B-917D-4AC5-A52E-B8C6FE1BE259">
      gpdraw.lsp
     </em>
     file indicated in bold:
    </p>
    <pre class="pre codeblock prettyprint">(setq PathAngle  (cdr (assoc 50 BoundaryData))
    Width        (cdr (assoc 40 BoundaryData))
    HalfWidth    (/ Width 2.00)
    StartPt      (cdr (assoc 10 BoundaryData))
    PathLength   (cdr (assoc 41 BoundaryData))
    angp90       (+ PathAngle (Degrees-&gt;Radians 90))
    angm90       (- PathAngle (Degrees-&gt;Radians 90))
    p1           (polar StartPt angm90 HalfWidth)
    p2           (polar p1 PathAngle PathLength)
    p3           (polar p2 angp90 Width)
    p4           (polar p3 (+ PathAngle (Degrees-&gt;Radians 180)) PathLength)
    poly2Dpoints (apply 'append
                   (mapcar '3dPoint-&gt;2dPoint (list p1 p2 p3 p4))
                 )
    poly3Dpoints (mapcar 'float (append p1 p2 p3 p4))

    ;; get the polyline style
    plineStyle   (strcase (cdr (assoc 4 BoundaryData)))
) ;_ end of setq

;; Add polyline to the model space using ActiveX automation
(setq pline (if (= plineStyle "LIGHT")
              ;; create a lightweight polyline
              (vla-addLightweightPolyline
                      *ModelSpace*      ; Global Definition for Model Space
                      (gp:list-&gt;variantArray poly2Dpoints) ;data conversion
              ) ;_ end of vla-addLightweightPolyline
     
              ;; or create an old-style polyline
              (vla-addPolyline
                      *ModelSpace*
                      (gp:list-&gt;variantArray poly3Dpoints) ;data conversion
              ) ;_ end of vla-addPolyline
            ) ;_ end of if
) ;_ end of setq</pre>
    <p class="p" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__WSFACF1429558A55DE1929BBDFEF458CE1C-7736">
     Typing the changes into your code can be very tricky, as you not only need to add code but also to delete some existing lines and rearrange others. It is recommended you copy the entire
     <samp class="ph codeph" id="GUID-D377C55C-466C-44D1-B049-6E714EEDA327__GUID-DFC0D526-3675-4B04-86D2-AB0DDBAEE444">
      setq
     </samp>
     statement from the online tutorial and paste it into your code.
    </p>
   </div>
  </div>
  <div class="related-links">
   <div class="familylinks">
    <div class="parentlink">
     <strong>
      Parent topic:
     </strong>
     <a class="link" href="Lesson_4_Creating_a_Project_and_Adding_the_Interface_Visual_LISP_IDE.html">
      Lesson 4: Creating a Project and Adding the Interface (Visual LISP IDE)
     </a>
    </div>
    <div class="previouslink">
     <strong>
      Previous topic:
     </strong>
     <a class="link" href="Updating_a_Stubbed_Out_Function.html">
      Updating a Stubbed-Out Function
     </a>
    </div>
    <div class="nextlink">
     <strong>
      Next topic:
     </strong>
     <a class="link" href="Cleaning_Up.html">
      Cleaning Up
     </a>
    </div>
   </div>
  </div>
 </body>
</html>
