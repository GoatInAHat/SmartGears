<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="concept" name="topic-type"/>
  <meta content="/view/OARX/2025/ENU/" name="helpsystempath"/>
  <meta content="OARX" name="product"/>
  <meta content="2025" name="release"/>
  <meta content="Developer" name="book"/>
  <meta content="AutoCAD-AutoLISP-Tutorials" name="component"/>
  <meta content="25/4/2024" name="created"/>
  <meta content="ACD=2025" name="applies-to"/>
  <meta content="ACAD_E=2025" name="applies-to"/>
  <meta content="AMECH_PP=2025" name="applies-to"/>
  <meta content="ARCHDESK=2025" name="applies-to"/>
  <meta content="BLDSYS=2025" name="applies-to"/>
  <meta content="CIV3D=2025" name="applies-to"/>
  <meta content="MAP=2025" name="applies-to"/>
  <meta content="PLNT3D=2025" name="applies-to"/>
  <meta content="PNID=2025" name="applies-to"/>
  <meta content="STRDET=2025" name="applies-to"/>
  <meta content="UTLDESN=2025" name="applies-to"/>
  <meta content="CSY, DEU, ESP, FRA, HUN, ITA, KOR, PLK, PTB, RUS, CHS, CHT" name="applies-to-languages"/>
  <meta content="TRIDION" name="generatedby"/>
  <meta content="disable" name="user-comments"/>
  <meta content="GUID-87F4038B-C54A-4A2A-B122-FFE4DAB279C3" name="workflow-parent-id"/>
  <meta content="general" name="experiencelevel"/>
  <meta content="programmer" name="audience"/>
  <meta content="02/12/2019" name="modified"/>
  <meta content="autolisp" name="topic-subtype"/>
  <meta content="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1" name="topicid"/>
  <meta content="ENU" name="language"/>
  <title>
   Drawing the Rows
  </title>
  <link href="../../../../_assets/client-28da4093.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1">
  <div class="head">
   <div class="head-block">
    <div class="button-info">
     <span id="infoline">
     </span>
    </div>
    <div class="ancestry">
    </div>
    <div class="head-text">
     <h1>
      Drawing the Rows
     </h1>
    </div>
   </div>
  </div>
  <div class="body conbody">
   <div class="section" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-278EFA48-550E-4AA5-BDDD-90B0E76D27B3">
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-7713">
     See if you can make sense of the following function. Compare it to the pseudo-code and try to catch the geometric calculations just described. There may be a few AutoLISP functions that are new to you, refer to the AutoLISP documentation if you need help with these functions. For now, just read the code; do not write anything.
    </p>
    <pre class="pre codeblock prettyprint">(defun gp:Calculate-and-Draw-Tiles (BoundaryData / PathLength
                                    TileSpace TileRadius SpaceFilled SpaceToFill
                                    RowSpacing offsetFromCenter
                                    rowStartPoint pathWidth pathAngle
                                    ObjectCreationStyle TileList)
  (setq PathLength          (cdr (assoc 41 BoundaryData))
        TileSpace           (cdr (assoc 43 BoundaryData))
        TileRadius          (cdr (assoc 42 BoundaryData))
        SpaceToFill         (- PathLength TileRadius)
        RowSpacing          (* (+ TileSpace (* TileRadius 2.0))
                              (sin (Degrees-&gt;Radians 60))
                            ) ;_ end of *
        SpaceFilled         RowSpacing
        offsetFromCenter    0.0
        offsetDistance      (/ (+ (* TileRadius 2.0) TileSpace) 2.0)
        rowStartPoint       (cdr (assoc 10 BoundaryData))
        pathWidth           (cdr (assoc 40 BoundaryData))
        pathAngle           (cdr (assoc 50 BoundaryData))
        ObjectCreationStyle (strcase (cdr (assoc 3 BoundaryData)))
  ) ;_ end of setq

  ;; Compensate for the first call to gp:calculate-Draw-tile Row  
  ;; in the loop below.
  (setq rowStartPoint
        (polar rowStartPoint
               (+ pathAngle pi)
               (/ TileRadius 2.0)
        ) ;_ end of polar
  ) ;_ end of setq
  ;; Draw each row of tiles.
  (while (&lt;= SpaceFilled SpaceToFill)
    ;; Get the list of tiles created, adding them to our list.
    (setq tileList
          (append tileList
                  (gp:calculate-Draw-TileRow
                    (setq rowStartPoint
                          (polar rowStartPoint
                                 pathAngle
                                 RowSpacing
                          ) ;_ end of polar
                    ) ;_ end of setq
                    TileRadius
                    TileSpace
                    pathWidth
                    pathAngle
                    offsetFromCenter
                    ObjectCreationStyle
                  ) ;_ end of gp:calculate-Draw-TileRow
          ) ;_ end of append
          ;; Calculate the distance along the path for the next row.
          SpaceFilled
          (+ SpaceFilled RowSpacing)
          ;; Alternate between a zero and a positive offset
          ;; (causes alternate rows to be indented).
          offsetFromCenter
          (if (= offsetFromCenter 0.0)
            offsetDistance
            0.0
          ) ;_ end of if
    ) ;_ end of setq
  ) ;_ end of while
  ;; Return the list of tiles created.
  tileList
) ;_ end of defun</pre>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-7712">
     A couple of sections from the code may need a little extra explanation.
    </p>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-7711">
     The following code fragment occurs right before the
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-FFAA76E0-7E5B-4959-AC23-EDE95B488EF9">
      while
     </samp>
     loop begins:
    </p>
    <pre class="pre codeblock prettyprint">;; Compensate for the very first start point!!
(setq rowStartPoint(polar rowStartPoint 
(+ pathAngle pi)(/ TileRadius 2.0)))</pre>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-7710">
     There are three pieces to the puzzle of figuring out the logic behind this algorithm:
    </p>
    <ul class="ul" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WS1A9193826455F5FF18CB41610EC0A2E719-73BA">
     <li class="li" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WS1A9193826455F5FF-7F10494411F03A24F24-1D61">
      The
      <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-EB84CA4A-8507-4AFE-85B3-A10A0E810282">
       rowStartPoint
      </samp>
      variable starts its life within the
      <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-440C717E-D8C4-4716-854B-E83B383688F1">
       gp:Calculate-and-Draw-Tiles
      </samp>
      function by being assigned the point the user selected as the start point of the path.
     </li>
     <li class="li" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WS1A9193826455F5FF-7F10494411F03A24F24-1D60">
      The very first argument passed to the
      <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-BF9921E8-F469-43FB-9385-0191334EC958">
       gp:calculate-Draw-TileRow
      </samp>
      function does the following:
      <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-770F">
       <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-A8AE254D-788D-4853-88E2-A23EB5AE324D">
        (setq rowStartPoint(polar rowStartPoint pathAngle RowSpacing))
       </samp>
      </p>
      <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-770E">
       Another way of stating this is: At the time the
       <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-DB83ED95-1E8D-4365-881C-522DF27BC1EA">
        gp:calculate-Draw-TileRow
       </samp>
       function is called, the
       <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-9DB55507-AF50-4DE6-9972-983EDC041B4D">
        rowStartPoint
       </samp>
       variable is set to one
       <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-B8F4613E-2049-424D-AB58-E6E7D95C8DBA">
        RowSpacing
       </samp>
       distance beyond the current
       <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-2BE2ACCE-187F-4BF4-B64C-8FF208AB74B4">
        rowStartPoint
       </samp>
       .
      </p>
     </li>
     <li class="li" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WS1A9193826455F5FF-7F10494411F03A24F24-1D5F">
      The
      <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-AC786D34-3C0A-4AA3-B921-CCB8F3254F0B">
       rowStartPoint
      </samp>
      argument is used within
      <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-2CC18CDD-CAC2-4569-A0AE-0C0D945359DE">
       gp:calculate-Draw-TileRow
      </samp>
      as the starting point for the centers of the circles in the row.
     </li>
    </ul>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-770D">
     To compensate for the initial forward shifting of the
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-022D2FC2-D1B6-490E-9A09-FA64265BD68E">
      rowStartPoint
     </samp>
     during the drawing of the first row (that is, the first cycle through the
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-DFCEBAA0-B3A8-4F5D-B8B7-0F8FA26C305B">
      while
     </samp>
     loop), you will want to shift
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-A1E11D72-2ED4-45D4-B0D6-BBBEF7D38528">
      rowStartPoint
     </samp>
     slightly in the opposite direction. The aim is to avoid the appearance of a large margin of empty space between the path boundary and the first row. Half the
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-4A325D22-C213-482F-8030-211B23387753">
      TileRadius
     </samp>
     is a sufficient amount by which to move the point. This can be achieved by using
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-A9C4FAA9-0FD3-4270-9284-5E2ABADC4D55">
      polar
     </samp>
     to project
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-CEFF6F58-138F-4462-89E4-A67FFD4867E1">
      rowStartPoint
     </samp>
     along a vector oriented 180 degrees from the
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-DEEA431A-9941-41C8-BA9D-8603F6C971FA">
      PathAngle
     </samp>
     . If you think about it, this places the point temporarily outside the path boundary.
    </p>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-770C">
     The next fragment (modified for readability) may be a little puzzling:
    </p>
    <pre class="pre codeblock prettyprint">(setq tileList
  (append tileList
          (gp:calculate-Draw-TileRow
            (setq rowStartPoint
                  (polar rowStartPoint pathAngle RowSpacing)
            ) ;_ end of setq
            TileRadius
            TileSpace
            pathWidth
            pathAngle
            offsetFromCenter
            ObjectCreationStyle
          )
  )
)</pre>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-770B">
     In essence, there is
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-33C252AA-E0C5-451D-8587-41CEDFAC4F17">
      setq
     </samp>
     wrapped around an
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-5A7A4757-048B-4341-9315-80D45E989EE8">
      append
     </samp>
     wrapped around the call to
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-708B58DE-C542-497A-98A9-20AD111BEBD0">
      gp:calculate-Draw-TileRow
     </samp>
     .
    </p>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-770A">
     The
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-7E8F0BBA-3BBA-4477-BC5E-7EE4B698DE07">
      gp:calculate-Draw-TileRow
     </samp>
     function will return the Object IDs for each tile drawn. (The Object ID points to the tile object in the drawing.) You are drawing the tiles row by row, so the function returns the Object IDs of one row at a time. The
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-33628CA5-77A2-4E07-BCBD-E94FDDFB2ED6">
      append
     </samp>
     function adds the new Object IDs to any existing Object IDs stored in
     <samp class="ph codeph" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__GUID-8DB1863D-006A-4820-B13E-488B314EE12B">
      tileList
     </samp>
     .
    </p>
    <pre class="pre codeblock prettyprint">; Near the end of the function, you can find the following code fragment:
(setq offsetFromCenter
  (if (= offsetFromCenter 0.0)
    offsetDistance
    0.0
  )
)</pre>
    <p class="p" id="GUID-7E4CD912-4CC0-45D0-B7A6-FBAA882C91E1__WSFACF1429558A55DE1929BBDFEF458CE1C-7709">
     This is the offset toggle, which determines whether the row being drawn should begin with a circle centered on the path or offset from the path. The pseudo-code for this algorithm follows:
    </p>
    <pre class="pre codeblock prettyprint">; Set the offset amount to the following:
; If the offset is currently zero, set it to the offset distance;
; Otherwise, set it back to zero.</pre>
   </div>
  </div>
  <div class="related-links">
   <div class="familylinks">
    <div class="parentlink">
     <strong>
      Parent topic:
     </strong>
     <a class="link" href="Lesson_5_Drawing_the_Tiles_Visual_LISP_IDE.html">
      Lesson 5: Drawing the Tiles (Visual LISP IDE)
     </a>
    </div>
    <div class="previouslink">
     <strong>
      Previous topic:
     </strong>
     <a class="link" href="Applying_Some_Geometry.html">
      Applying Some Geometry
     </a>
    </div>
    <div class="nextlink">
     <strong>
      Next topic:
     </strong>
     <a class="link" href="Drawing_the_Tiles_in_a_Row.html">
      Drawing the Tiles in a Row
     </a>
    </div>
   </div>
  </div>
 </body>
</html>
