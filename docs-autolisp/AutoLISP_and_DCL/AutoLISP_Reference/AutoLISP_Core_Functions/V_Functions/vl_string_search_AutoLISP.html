<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="reference-adsk" name="topic-type"/>
  <meta content="/view/OARX/2025/ENU/" name="helpsystempath"/>
  <meta content="OARX" name="product"/>
  <meta content="2025" name="release"/>
  <meta content="Developer" name="book"/>
  <meta content="AutoCAD-AutoLISP-Reference" name="component"/>
  <meta content="21/10/2024" name="created"/>
  <meta content="ACD=2025" name="applies-to"/>
  <meta content="ACAD_E=2025" name="applies-to"/>
  <meta content="AMECH_PP=2025" name="applies-to"/>
  <meta content="ARCHDESK=2025" name="applies-to"/>
  <meta content="BLDSYS=2025" name="applies-to"/>
  <meta content="CIV3D=2025" name="applies-to"/>
  <meta content="MAP=2025" name="applies-to"/>
  <meta content="PLNT3D=2025" name="applies-to"/>
  <meta content="PNID=2025" name="applies-to"/>
  <meta content="STRDET=2025" name="applies-to"/>
  <meta content="UTLDESN=2025" name="applies-to"/>
  <meta content="TRIDION" name="generatedby"/>
  <meta content="disable" name="user-comments"/>
  <meta content="Searches for the specified pattern in a string" name="description"/>
  <meta content="VL-STRING-SEARCH" name="contextid"/>
  <meta content="general" name="experiencelevel"/>
  <meta content="programmer" name="audience"/>
  <meta content="29/03/2023" name="modified"/>
  <meta content="autolisp" name="topic-subtype"/>
  <meta content="function" name="topic-subtype"/>
  <meta content="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6" name="topicid"/>
  <meta content="ENU" name="language"/>
  <title>
   vl-string-search (AutoLISP)
  </title>
  <link href="../../../../_assets/client-28da4093.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6">
  <div class="head">
   <div class="head-block">
    <div class="button-info">
     <span id="infoline">
     </span>
    </div>
    <div class="ancestry">
    </div>
    <div class="head-text">
     <h1>
      vl-string-search (AutoLISP)
     </h1>
    </div>
   </div>
  </div>
  <div class="body referencebody-adsk">
   <p class="shortdesc">
    Searches for the specified pattern in a string
   </p>
   <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-E049A211-8422-4856-8878-401FA04484E5">
    <strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-0A75B4A3-BD6D-4633-AB76-DE70E52BC48F">
     Supported Platforms:
    </strong>
    Windows, Mac OS, and Web
   </p>
   <div class="section" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-11DF2BA9-67D8-4909-A822-E18354BF381B">
    <h2 class="title sectiontitle">
     Signature
    </h2>
    <pre class="pre codeblock prettyprint">(vl-string-search <em class="ph i" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-F6A7FCAA-BE32-4172-980C-72A11418DEE6">pattern str [start-pos]</em>)</pre>
    <div class="section" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__WS1A9193826455F5FF-1E1423D1125831BDA67-7AB5">
     <dl class="dl" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__WS1A9193826455F5FF-1E1423D1125831BDA67-7AB5">
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-E50EC77B-5A22-463C-B331-11902456E84B">
        pattern
       </em>
      </dt>
      <dd class="dd" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-82E48ACC-F117-4154-A006-136BA5524C94">
       <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-60427CA9-FA51-4705-8CB5-ABB813D5F039">
        <strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-DB92B733-16A1-411B-B0D4-0127083259F8">
         Type:
        </strong>
        String
       </p>
       <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__WSFACF1429558A55DE11F0759FF1E4B858C-304A">
        The textual value containing the pattern to be searched for.
       </p>
      </dd>
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-9938BBF5-5EF3-4B93-90CD-31EA472AE546">
        str
       </em>
      </dt>
      <dd class="dd" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-402341F3-C1B0-4B91-A569-F35FDA1EC487">
       <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-4E5B3D4C-D7F5-4B61-BF86-3576521C9485">
        <strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-38E57412-06C4-4D9E-A39A-201177F2B50D">
         Type:
        </strong>
        String
       </p>
       <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__WSFACF1429558A55DE11F0759FF1E4B858C-3049">
        The textual value to be searched for
        <em class="ph i" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-0D35F9DD-D30A-414F-A982-143755EBCF27">
         pattern
        </em>
        .
       </p>
      </dd>
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-D9888E98-15A5-4EB3-802D-2268B1A23CC0">
        start-pos
       </em>
      </dt>
      <dd class="dd" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-0157FA53-EE92-434E-B610-58BC4580AF8F">
       <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-FD3E1C08-CCD7-4AE7-B5F5-95149644BEAC">
        <strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-AAB04F31-0382-40D3-A8FA-3A6307864ACC">
         Type:
        </strong>
        Integer
       </p>
       <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__WSFACF1429558A55DE11F0759FF1E4B858C-3048">
        A numeric value identifying the starting position of the search; 0 if omitted.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="section" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__SECTION_9574C07A0B6E415A81C40D10771CA42E">
    <h2 class="title sectiontitle">
     Return Values
    </h2>
    <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-33188E65-4730-4D69-BEEE-D15EE640AC9B">
     <strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-4C7C9ADE-1417-443C-B565-A446959DDD2E">
      Type:
     </strong>
     Integer
    </p>
    <p class="p" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__WSFACF1429558A55DE11F0759FF1E4B858C-3046">
     A numeric value representing the position in the string where the specified
     <em class="ph i" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-13BF3A0D-64AD-42AE-AFC8-AC46C830D3B6">
      pattern
     </em>
     was found; otherwise
     <samp class="ph codeph" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-6A527784-A3E9-4DF9-96DE-C033F593C9D9">
      nil
     </samp>
     if the pattern is not found; the first character of the string is position 0.
    </p>
   </div>
   <div class="section" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__SECTION_B19F170A7FA5405F9B86221A67A5994F">
    <h2 class="title sectiontitle">
     Release Information
    </h2>
    <ul class="ul" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__UL_572BA0328753473C9A6535F9270F27DA">
     <p class="p">
      <strong class="ph b">
       Releases:
      </strong>
     </p>
     <li class="li" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__LI_5BA8D109FBE84B0ABFDE371F30B83870">
      <span class="ph msgph prodname">
       AutoCAD R12 and later on Windows
      </span>
     </li>
     <li class="li" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__LI_56E644EE23CF4D2C8F04BA99C5DF5E56">
      <span class="ph msgph prodname">
       AutoCAD 2011 and later on Mac OS
      </span>
     </li>
    </ul>
   </div>
   <div class="section" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__SECTION_F86F9368A32246948D813FC617BCE97F">
    <h2 class="title sectiontitle">
     History
    </h2>
    <ul class="ul" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__UL_F42014237DDA4B7992D171F1F1A43023">
     <p class="p">
      <strong class="ph b">
       <span class="ph msgph prodname">
        AutoCAD 2021
       </span>
      </strong>
     </p>
     <li class="li" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__LI_731D446B56554990B05138FA6C9D3FBC">
      <samp class="ph codeph">
       <em class="ph i">
        pattern
       </em>
      </samp>
      and
      <samp class="ph codeph">
       <em class="ph i">
        str
       </em>
      </samp>
      arguments previously accepted ASCII text strings or characters, but they now accept Unicode text strings or characters.
     </li>
     <li class="li" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__LI_1844AAD909B5435397151934A5F7E90A">
      Return value was modified to support Unicode characters and might be different than earlier releases. In earlier releases, the length of a Unicode character was improperly calculated. For example,
      <samp class="ph codeph">
       (vl-string-search "€" "€abc中€" 1)
      </samp>
      previously returned 11, but now returns 5.
     </li>
     <li class="li" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__LI_F5399D16FAC34559B47468018FD77996">
      LISPSYS system variable controls which AutoLISP engine is used and the behavior of the function.
      <ul class="ul" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-AF226B3D-1EE4-4E17-A5B2-93125326C58C">
       <li class="li" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__LI_5061BC76C2C54B5F980B34EA2AF5BF53">
        0 - ASCII character support (legacy behavior)
       </li>
       <li class="li" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__LI_25F0B978C3BA451A97AD73931A912C45">
        1 or 2 - Unicode character support
       </li>
      </ul>
      <div class="note note" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-772E5167-A0B6-436C-B074-8D62816FB9C2">
       <span class="notetitle">
        Note:
       </span>
       After the value of the LISPSYS system variable has been changed, AutoCAD must be restarted for the change to take affect.
      </div>
     </li>
    </ul>
   </div>
   <div class="section" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__SECTION_CE1593A94B5B44D7A157894B882322F6">
    <h2 class="title sectiontitle">
     Examples
    </h2>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-40988222-C6DE-4A25-A3EE-55624BA18382">(vl-string-search "foo" "pfooyey on you")</strong>
1

<strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-FB0F81CD-D423-4D2E-8822-343C5A671EAF">(vl-string-search "who" "pfooyey on you")</strong>
nil

<strong class="ph b" id="GUID-4E7AE1DA-1ED5-4D96-A7D3-34241AA94AA6__GUID-A9A13EA9-675A-45D7-A35C-146F8953BEA1">(vl-string-search "foo" "fooey-more-fooey" 1)</strong>
11

<strong class="ph b">(vl-string-search "€" "€abc中€")</strong>
0

<strong class="ph b">(vl-string-search "测试" "€abc中€" 1)</strong>
nil

<strong class="ph b">(vl-string-search "€" "€abc中€" 1)</strong>
5</pre>
   </div>
  </div>
  <div class="related-links">
   <div class="relinfo relconcepts">
    <h4 class="related">
     Related Concepts
    </h4>
    <ul>
     <li>
      <a class="link" href="../Functions_By_Functionality/String_Handling_Functions_Reference_AutoLISP.html">
       String-Handling Functions Reference (AutoLISP)
      </a>
     </li>
    </ul>
   </div>
   <div class="relinfo relref">
    <h4 class="related">
     Related Reference
    </h4>
    <ul>
     <li>
      <a class="link" href="vl_string_mismatch_AutoLISP.html" title="Returns the length of the longest common prefix for two strings, starting at specified positions">
       vl-string-mismatch (AutoLISP)
      </a>
     </li>
     <li>
      <a class="link" href="vl_string_position_AutoLISP.html" title="Looks for a character with the specified character code in a string">
       vl-string-position (AutoLISP)
      </a>
     </li>
     <li>
      <a class="link" href="vl_string_subst_AutoLISP.html" title="Substitutes one string for another, within a string">
       vl-string-subst (AutoLISP)
      </a>
     </li>
     <li>
      <a class="link" href="vl_string_translate_AutoLISP.html" title="Replaces characters in a string with a specified set of characters">
       vl-string-translate (AutoLISP)
      </a>
     </li>
    </ul>
   </div>
  </div>
 </body>
</html>
