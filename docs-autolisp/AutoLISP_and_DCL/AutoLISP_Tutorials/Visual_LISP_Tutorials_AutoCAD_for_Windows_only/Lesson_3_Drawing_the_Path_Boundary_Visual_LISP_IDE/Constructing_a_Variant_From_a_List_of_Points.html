<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="concept" name="topic-type"/>
  <meta content="/view/OARX/2025/ENU/" name="helpsystempath"/>
  <meta content="OARX" name="product"/>
  <meta content="2025" name="release"/>
  <meta content="Developer" name="book"/>
  <meta content="AutoCAD-AutoLISP-Tutorials" name="component"/>
  <meta content="25/4/2024" name="created"/>
  <meta content="ACD=2025" name="applies-to"/>
  <meta content="ACAD_E=2025" name="applies-to"/>
  <meta content="AMECH_PP=2025" name="applies-to"/>
  <meta content="ARCHDESK=2025" name="applies-to"/>
  <meta content="BLDSYS=2025" name="applies-to"/>
  <meta content="CIV3D=2025" name="applies-to"/>
  <meta content="MAP=2025" name="applies-to"/>
  <meta content="PLNT3D=2025" name="applies-to"/>
  <meta content="PNID=2025" name="applies-to"/>
  <meta content="STRDET=2025" name="applies-to"/>
  <meta content="UTLDESN=2025" name="applies-to"/>
  <meta content="CSY, DEU, ESP, FRA, HUN, ITA, KOR, PLK, PTB, RUS, CHS, CHT" name="applies-to-languages"/>
  <meta content="TRIDION" name="generatedby"/>
  <meta content="disable" name="user-comments"/>
  <meta content="GUID-D0CF600F-566E-4D79-9DEB-3039A97E5348" name="workflow-parent-id"/>
  <meta content="general" name="experiencelevel"/>
  <meta content="programmer" name="audience"/>
  <meta content="16/02/2020" name="modified"/>
  <meta content="autolisp" name="topic-subtype"/>
  <meta content="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B" name="topicid"/>
  <meta content="ENU" name="language"/>
  <title>
   Constructing a Variant From a List of Points
  </title>
  <link href="../../../../_assets/client-28da4093.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B">
  <div class="head">
   <div class="head-block">
    <div class="button-info">
     <span id="infoline">
     </span>
    </div>
    <div class="ancestry">
    </div>
    <div class="head-text">
     <h1>
      Constructing a Variant From a List of Points
     </h1>
    </div>
   </div>
  </div>
  <div class="body conbody">
   <div class="section" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-D22B72D8-9521-4201-B684-0756D5B5E211">
    <p class="p" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__WSFACF1429558A55DE1929BBDFEF458CE1C-778E">
     So far, the data in the polypoints variable is in a list format suitable for many AutoLISP calls. However, the data is to be supplied as an input parameter to an ActiveX call that expects a variant array of doubles. You can use another utility function to make the required conversion from list to variant:
    </p>
    <pre class="pre codeblock prettyprint">(defun gp:list-&gt;variantArray (ptsList / arraySpace sArray)
  ; allocate space for an array of 2d points stored as doubles
  (setq arraySpace (vlax-make-safearray
              vlax-vbdouble ; element type
              (cons 0
                    (- (length ptsList) 1)
                    ) ; array dimension
              )
  )

  (setq sArray (vlax-safearray-fill arraySpace ptsList))

  ; return array variant
  (vlax-make-variant sArray)
)</pre>
    <p class="p" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__WSFACF1429558A55DE1929BBDFEF458CE1C-778D">
     The following actions take place in
     <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-2801C46D-D674-41BB-8116-E5D24F08520E">
      gp:list-&gt;variantArray
     </samp>
     :
    </p>
    <ul class="ul" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__WS1A9193826455F5FF18CB41610EC0A2E719-735E">
     <li class="li" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__WS1A9193826455F5FF-7F10494411F03A24F24-1E36">
      The
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-B1B38A01-C094-4EC5-9A04-0F5BFAC53F39">
       vlax-make-safearray
      </samp>
      function is called to allocate an array of doubles (
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-51329F14-501D-4794-8B94-EEE224D8B696">
       vlax-vbdouble
      </samp>
      ). The
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-432BF2AF-DD92-4877-8750-92A1B9887322">
       vlax-make-safearray
      </samp>
      function also requires you to specify the lower and upper index boundaries of the array. In
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-3B9957B8-1674-44BC-B689-B33115703E21">
       gp:list-&gt;variantArray
      </samp>
      , the call to
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-56F3C756-9B2F-4415-806A-9FD0232A3094">
       vlax-make-safearray
      </samp>
      specifies a start index of 0 and sets the upper limit to one less than the number of elements passed to it (
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-D1764AA3-9396-41FF-88E3-5EA7226FF1C6">
       ptsList
      </samp>
      ).
     </li>
     <li class="li" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__WS1A9193826455F5FF-7F10494411F03A24F24-1E35">
      The
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-4E37B44D-4A50-408C-BAB4-63CE6468A19E">
       vlax-safearray-fill
      </samp>
      function is called to populate the array with the elements in the point list.
     </li>
     <li class="li" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__WS1A9193826455F5FF-7F10494411F03A24F24-1E34">
      The
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-79175E20-C37E-4D9A-B0CC-671CB83E86B7">
       vlax-make-variant
      </samp>
      is called to convert the safearray into a variant. As the last function call in
      <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-6FCBBD04-C2B0-48D6-B3A3-C5890CE88ACD">
       gp:list-&gt;variantArray
      </samp>
      , the return value is passed to the calling function.
     </li>
    </ul>
    <p class="p" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__WSFACF1429558A55DE1929BBDFEF458CE1C-778C">
     The following is an example of a function call that invokes
     <samp class="ph codeph" id="GUID-A3314A92-F974-4A3E-B673-5F074A7A3B2B__GUID-8D17DED1-B5CB-45DA-A3B1-7FC42ABD5AD1">
      gp:list-&gt;variantArray
     </samp>
     to convert a list to a variant array of doubles:
    </p>
    <pre class="pre codeblock prettyprint">; data conversion from list to variant
(setq VLADataPts (gp:list-&gt;variantArray polypoints))</pre>
   </div>
  </div>
  <div class="related-links">
   <div class="familylinks">
    <div class="parentlink">
     <strong>
      Parent topic:
     </strong>
     <a class="link" href="Lesson_3_Drawing_the_Path_Boundary_Visual_LISP_IDE.html">
      Lesson 3: Drawing the Path Boundary (Visual LISP IDE)
     </a>
    </div>
    <div class="previouslink">
     <strong>
      Previous topic:
     </strong>
     <a class="link" href="Constructing_an_Array_of_Polyline_Points.html">
      Constructing an Array of Polyline Points
     </a>
    </div>
    <div class="nextlink">
     <strong>
      Next topic:
     </strong>
     <a class="link" href="Putting_It_All_Together_AutoLISP.html">
      Putting It All Together (AutoLISP)
     </a>
    </div>
   </div>
  </div>
 </body>
</html>
