<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="concept" name="topic-type"/>
  <meta content="/view/OARX/2025/ENU/" name="helpsystempath"/>
  <meta content="OARX" name="product"/>
  <meta content="2025" name="release"/>
  <meta content="Developer" name="book"/>
  <meta content="AutoCAD-AutoLISP-Tutorials" name="component"/>
  <meta content="25/4/2024" name="created"/>
  <meta content="ACD=2025" name="applies-to"/>
  <meta content="ACAD_E=2025" name="applies-to"/>
  <meta content="AMECH_PP=2025" name="applies-to"/>
  <meta content="ARCHDESK=2025" name="applies-to"/>
  <meta content="BLDSYS=2025" name="applies-to"/>
  <meta content="CIV3D=2025" name="applies-to"/>
  <meta content="MAP=2025" name="applies-to"/>
  <meta content="PLNT3D=2025" name="applies-to"/>
  <meta content="PNID=2025" name="applies-to"/>
  <meta content="STRDET=2025" name="applies-to"/>
  <meta content="UTLDESN=2025" name="applies-to"/>
  <meta content="CSY, DEU, ESP, FRA, HUN, ITA, KOR, PLK, PTB, RUS, CHS, CHT" name="applies-to-languages"/>
  <meta content="TRIDION" name="generatedby"/>
  <meta content="disable" name="user-comments"/>
  <meta content="GUID-D0CF600F-566E-4D79-9DEB-3039A97E5348" name="workflow-parent-id"/>
  <meta content="general" name="experiencelevel"/>
  <meta content="programmer" name="audience"/>
  <meta content="02/12/2019" name="modified"/>
  <meta content="autolisp" name="topic-subtype"/>
  <meta content="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5" name="topicid"/>
  <meta content="ENU" name="language"/>
  <title>
   Obtaining a Pointer to Model Space
  </title>
  <link href="../../../../_assets/client-28da4093.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5">
  <div class="head">
   <div class="head-block">
    <div class="button-info">
     <span id="infoline">
     </span>
    </div>
    <div class="ancestry">
    </div>
    <div class="head-text">
     <h1>
      Obtaining a Pointer to Model Space
     </h1>
    </div>
   </div>
  </div>
  <div class="body conbody">
   <div class="section" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-F4E41CD4-3094-4B6F-8FBD-94698B71489C">
    <p class="p" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__WSFACF1429558A55DE1929BBDFEF458CE1C-779C">
     When you add entities through ActiveX functions, you need to identify the model space or paper space in which the entity is to be inserted. (In ActiveX terminology, entities are
     <em class="ph i" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-D293B7CA-6C43-401C-BF4A-043200C620C8">
      objects
     </em>
     , but this tutorial will continue using the term entity.) To tell AutoCAD which space the new entities should occupy, you need to obtain a pointer to that space. Unfortunately, obtaining a pointer to model space is not a simple, single-shot function. The following code fragment shows how the operation needs to be set up:
    </p>
    <pre class="pre codeblock prettyprint">(vla-get-ModelSpace (vla-get-ActiveDocument
  (vlax-get-Acad-Object)))</pre>
    <p class="p" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__WSFACF1429558A55DE1929BBDFEF458CE1C-779B">
     Working from the inside out, the
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-C7FDA8FC-23B0-42F5-9178-1837B056E89F">
      vlax-get-Acad-Object
     </samp>
     function retrieves a pointer to AutoCAD. This pointer is passed to the
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-0EE80CDD-ABB6-4AEC-B13B-ADC4A4BB5E3D">
      vla-get-ActiveDocument
     </samp>
     function, which retrieves a pointer to the active drawing (document) within AutoCAD. The Active Document pointer is then passed to the
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-B6845684-D0B3-4078-BE38-D2138D6AEF24">
      vla-get-ModelSpace
     </samp>
     function that retrieves a pointer to the model space of the current drawing.
    </p>
    <p class="p" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__WSFACF1429558A55DE1929BBDFEF458CE1C-779A">
     This is not the kind of expression you want to type over and over. For example, look at how much more complicated the code for adding a polyline using ActiveX appears when the entire model space expression is used:
    </p>
    <pre class="pre codeblock prettyprint">(setq pline (vla-addLightweightPolyline
  (vla-get-ModelSpace
    (vla-get-ActiveDocument
      (vlax-get-Acad-Object)
    )
  )
  VLADataPts)
)
(vla-put-closed pline T)</pre>
    <p class="p" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__WSFACF1429558A55DE1929BBDFEF458CE1C-7799">
     The function is definitely less understandable. Not only that, but within every expression within your program where an entity is created, you repeat the same set of nested functions. This demonstrates one of the few excellent uses for global variables. The garden path application can add a lot of entities to model space (think of all the tiles in the path), so, set up a global variable to store the pointer to the model space, as in the following code:
    </p>
    <pre class="pre codeblock prettyprint">(setq *ModelSpace* (vla-get-ModelSpace (vla-get-ActiveDocument 
                 (vlax-get-Acad-Object))))</pre>
    <p class="p" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__WSFACF1429558A55DE1929BBDFEF458CE1C-7798">
     You can use the variable
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-3F9C26D3-6BE4-41B7-AE23-09AF04B73B74">
      *ModelSpace*
     </samp>
     anytime you call an ActiveX entity creation function. The only tricky thing with this scheme is the
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-7545C85B-03C0-45DC-B791-680E3A3147A8">
      *ModelSpace*
     </samp>
     variable must be ready to go before you start drawing. For this reason, the
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-B259D9E1-7C45-4204-A0C8-DDDC5C965AF1">
      setq
     </samp>
     establishing this variable will be called at the time the application is loaded, immediately after the call to
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-4E0AE4D2-DE02-4D4C-B2BC-4EE0B790638F">
      vl-load-com
     </samp>
     . These calls will be placed before any
     <samp class="ph codeph" id="GUID-0A1B6F6E-B686-4816-A8E0-618A197C49A5__GUID-02875C77-49C3-466F-966F-EC88782C2528">
      defun
     </samp>
     in the program file. As a result, they are executed as soon as the file is loaded.
    </p>
   </div>
  </div>
  <div class="related-links">
   <div class="familylinks">
    <div class="parentlink">
     <strong>
      Parent topic:
     </strong>
     <a class="link" href="Lesson_3_Drawing_the_Path_Boundary_Visual_LISP_IDE.html">
      Lesson 3: Drawing the Path Boundary (Visual LISP IDE)
     </a>
    </div>
    <div class="previouslink">
     <strong>
      Previous topic:
     </strong>
     <a class="link" href="Ensuring_That_ActiveX_Is_Loaded.html">
      Ensuring That ActiveX Is Loaded
     </a>
    </div>
    <div class="nextlink">
     <strong>
      Next topic:
     </strong>
     <a class="link" href="Constructing_an_Array_of_Polyline_Points.html">
      Constructing an Array of Polyline Points
     </a>
    </div>
   </div>
  </div>
 </body>
</html>
