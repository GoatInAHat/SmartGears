<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="reference-adsk" name="topic-type"/>
  <meta content="/view/OARX/2025/ENU/" name="helpsystempath"/>
  <meta content="OARX" name="product"/>
  <meta content="2025" name="release"/>
  <meta content="Developer" name="book"/>
  <meta content="AutoCAD-AutoLISP-Reference" name="component"/>
  <meta content="21/10/2024" name="created"/>
  <meta content="ACD=2025" name="applies-to"/>
  <meta content="ACAD_E=2025" name="applies-to"/>
  <meta content="AMECH_PP=2025" name="applies-to"/>
  <meta content="ARCHDESK=2025" name="applies-to"/>
  <meta content="BLDSYS=2025" name="applies-to"/>
  <meta content="CIV3D=2025" name="applies-to"/>
  <meta content="MAP=2025" name="applies-to"/>
  <meta content="PLNT3D=2025" name="applies-to"/>
  <meta content="PNID=2025" name="applies-to"/>
  <meta content="STRDET=2025" name="applies-to"/>
  <meta content="UTLDESN=2025" name="applies-to"/>
  <meta content="TRIDION" name="generatedby"/>
  <meta content="disable" name="user-comments"/>
  <meta content="Substitutes one string for another, within a string" name="description"/>
  <meta content="VL-STRING-SUBST" name="contextid"/>
  <meta content="general" name="experiencelevel"/>
  <meta content="programmer" name="audience"/>
  <meta content="29/03/2023" name="modified"/>
  <meta content="autolisp" name="topic-subtype"/>
  <meta content="function" name="topic-subtype"/>
  <meta content="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D" name="topicid"/>
  <meta content="ENU" name="language"/>
  <title>
   vl-string-subst (AutoLISP)
  </title>
  <link href="../../../../_assets/client-28da4093.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D">
  <div class="head">
   <div class="head-block">
    <div class="button-info">
     <span id="infoline">
     </span>
    </div>
    <div class="ancestry">
    </div>
    <div class="head-text">
     <h1>
      vl-string-subst (AutoLISP)
     </h1>
    </div>
   </div>
  </div>
  <div class="body referencebody-adsk">
   <p class="shortdesc">
    Substitutes one string for another, within a string
   </p>
   <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-E049A211-8422-4856-8878-401FA04484E5">
    <strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-0A75B4A3-BD6D-4633-AB76-DE70E52BC48F">
     Supported Platforms:
    </strong>
    Windows, Mac OS, and Web
   </p>
   <div class="section" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-C778E40C-1D87-4A92-9D47-E3376D9C6127">
    <h2 class="title sectiontitle">
     Signature
    </h2>
    <pre class="pre codeblock prettyprint">(vl-string-subst <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-6E1AF099-E1EE-43C8-81F7-92492B0DD8A6">new-str pattern str [start-pos]</em>)</pre>
    <div class="section" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WS1A9193826455F5FF-1E1423D1125831BDA67-7AB4">
     <dl class="dl" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WS1A9193826455F5FF-1E1423D1125831BDA67-7AB4">
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-8ADB8A35-CA57-4D6C-87B9-D15F67C89D5B">
        new-str
       </em>
      </dt>
      <dd class="dd" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-5C29D1DE-4DC8-4DAD-A38A-82C64C65A455">
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-4A606158-A53A-4552-A708-505E1B6FEC7E">
        <strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-E593F6E0-B4C2-4C28-9195-A3D79C613E12">
         Type:
        </strong>
        String
       </p>
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3043">
        The textual value to be substituted for
        <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-AAEA347C-3EA1-4E66-BAD1-E63DAE792869">
         pattern
        </em>
        .
       </p>
      </dd>
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-E5E7E950-A252-44BE-9776-B5F68D0EA26C">
        pattern
       </em>
      </dt>
      <dd class="dd" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-9E0251D1-5676-48D1-B5A5-69793F38A13D">
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-F2AB48F5-57E6-47D3-A52D-77CE117F0F57">
        <strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-EAEFECB1-A9F1-4378-941F-15CC757C95E8">
         Type:
        </strong>
        String
       </p>
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3042">
        The textual value containing the pattern to be replaced.
       </p>
      </dd>
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-54C1D992-3EFA-4E99-873E-F02A983203DB">
        str
       </em>
      </dt>
      <dd class="dd" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-0C390C85-1364-480C-A411-52BB542E1E6F">
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-6B74510D-68E9-43A2-AA80-7A976428DF76">
        <strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-159E9125-CD43-4999-BCC8-D6AE6F0C77B8">
         Type:
        </strong>
        String
       </p>
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3041">
        The textual value to be searched for
        <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-18DEDEF1-B44F-4A0B-BD24-A11D82DDA65A">
         pattern
        </em>
        .
       </p>
      </dd>
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-14FFC0E8-DFA4-4C6B-81C3-C8495996FF20">
        start-pos
       </em>
      </dt>
      <dd class="dd" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-7B9BDF6A-91AB-492C-9275-A52DB39D369C">
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-0A0C35A9-FCB8-4A30-A195-C5203274D620">
        <strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-53CABB32-7328-41B0-8CD1-746ED7A9253E">
         Type:
        </strong>
        Integer
       </p>
       <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3040">
        A numeric value identifying the starting position of the search; 0 if omitted.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="section" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__SECTION_BC68DA12F00C4066A83535694633AB72">
    <h2 class="title sectiontitle">
     Return Values
    </h2>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-D7B22200-120F-44D4-ADD0-E3402F4FA12B">
     <strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-1205EAE9-2E3D-4CCD-BF59-A82A6897F93E">
      Type:
     </strong>
     String
    </p>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-303D">
     The value of
     <em class="ph i" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-6997BB6F-40AB-4445-B134-3F0DAAD3ECBF">
      str
     </em>
     after any substitutions have been made.
    </p>
   </div>
   <div class="section" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__SECTION_9A20E16C6E704739B4BCA2D07EDBAEC9">
    <h2 class="title sectiontitle">
     Remarks
    </h2>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-303F">
     Note that the search is case-sensitive, and that
     <samp class="ph codeph" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-7D9C2E22-6900-47FA-B382-457223A3F572">
      vl-string-subst
     </samp>
     substitutes only the first occurrence it finds of the string.
    </p>
   </div>
   <div class="section" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__SECTION_C3F0E3C4ADCB44D99AEEC4849E7BCBEF">
    <h2 class="title sectiontitle">
     Release Information
    </h2>
    <ul class="ul" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__UL_43EFED2E1AD146D696666C2E24708F27">
     <p class="p">
      <strong class="ph b">
       Releases:
      </strong>
     </p>
     <li class="li" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__LI_1CF7AE53F58E4ACC9644A118C5512188">
      <span class="ph msgph prodname">
       AutoCAD R12 and later on Windows
      </span>
     </li>
     <li class="li" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__LI_EC22DD71076446D4ACBEA3D196446711">
      <span class="ph msgph prodname">
       AutoCAD 2011 and later on Mac OS
      </span>
     </li>
    </ul>
   </div>
   <div class="section" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__SECTION_190A39DBED964BA184E25398935666E8">
    <h2 class="title sectiontitle">
     History
    </h2>
    <ul class="ul" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__UL_D0781425E62E4419A4617067B812B30D">
     <p class="p">
      <strong class="ph b">
       <span class="ph msgph prodname">
        AutoCAD 2021
       </span>
      </strong>
     </p>
     <li class="li" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__LI_E3F85D04CACC45F6B2FE4FCBB9362D27">
      <samp class="ph codeph">
       <em class="ph i">
        new-str
       </em>
      </samp>
      ,
      <samp class="ph codeph">
       <em class="ph i">
        pattern
       </em>
      </samp>
      and
      <samp class="ph codeph">
       <em class="ph i">
        str
       </em>
      </samp>
      arguments previously accepted ASCII text strings or characters, but now accept Unicode text strings or characters.
     </li>
     <li class="li" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__LI_131EB0FB0447441288060F2E95F199FC">
      Return value was modified to support Unicode characters and might be different than earlier releases. In earlier releases, the length of a Unicode character was improperly calculated. For example,
      <samp class="ph codeph">
       (vl-string-subst "中" "€" "abc中€bec" 5)
      </samp>
      previously returned "abc中中bec", but now returns "abc中€bec".
     </li>
     <li class="li" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__LI_212DD3528C3848FDBB1F8448ECE597DD">
      LISPSYS system variable controls which AutoLISP engine is used and the behavior of the function.
      <ul class="ul" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-80C1EA57-2395-4460-98E5-EBC32D4618E5">
       <li class="li" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__LI_145697B15B7E47F296CE5208CF30C043">
        0 - ASCII character support (legacy behavior)
       </li>
       <li class="li" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__LI_B22D5CB5EEB2462B8A700A871F541259">
        1 or 2 - Unicode character support
       </li>
      </ul>
      <div class="note note" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-CB5026D0-7186-4D2C-A88E-339DF73585BC">
       <span class="notetitle">
        Note:
       </span>
       After the value of the LISPSYS system variable has been changed, AutoCAD must be restarted for the change to take affect.
      </div>
     </li>
    </ul>
   </div>
   <div class="section" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__SECTION_7968554AC7004EEC8759B0E4CF559A63">
    <h2 class="title sectiontitle">
     Examples
    </h2>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-303B">
     Replace the string "Ben" with "Obi-wan":
    </p>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-BD2E3796-19B7-498E-8086-E520217BB1E0">(vl-string-subst "Obi-wan" "Ben" "Ben Kenobi")</strong>
"Obi-wan Kenobi"</pre>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-303A">
     Replace "Ben" with "Obi-wan":
    </p>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-A6B89228-244E-48E5-8E30-E7F5F16E586F">(vl-string-subst "Obi-wan" "Ben" "ben Kenobi")</strong>
"ben Kenobi"</pre>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3039">
     Nothing was substituted because
     <samp class="ph codeph" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-21BAC874-9C73-41AB-84E0-3A79EB275E68">
      vl-string-subst
     </samp>
     did not find a match for "Ben"; the "ben" in the string that was searched begins with a lowercase "b".
    </p>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3038">
     Replace "Ben" with "Obi-wan":
    </p>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-021B1A49-D205-4288-8E52-93965D167179">(vl-string-subst "Obi-wan" "Ben" "Ben Kenobi Ben")</strong>
"Obi-wan Kenobi Ben"</pre>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3037">
     Note that there are two occurrences of "Ben" in the string that was searched, but
     <samp class="ph codeph" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-6B9194D6-157F-4D3F-893B-339B031C2311">
      vl-string-subst
     </samp>
     replaces only the first occurrence.
    </p>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3036">
     Replace "Ben" with "Obi-wan," but start the search at the fourth character in the string:
    </p>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-CD40BCC4-0145-4D36-AEFF-003840979F69">(vl-string-subst "Obi-wan" "Ben" "Ben \"Ben\" Kenobi" 3)</strong>
"Ben \"Obi-wan\" Kenobi"</pre>
    <p class="p" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__WSFACF1429558A55DE11F0759FF1E4B858C-3035">
     There are two occurrences of "Ben" in the string that was searched, but because
     <samp class="ph codeph" id="GUID-D8EE91DC-D4DB-43E0-9AFE-5FA166C0896D__GUID-5BA410C2-AAD3-45E1-B7DC-367357EC4104">
      vl-string-subst
     </samp>
     was instructed to begin searching at the fourth character, it found and replaced the second occurrence, not the first.
    </p>
   </div>
  </div>
  <div class="related-links">
   <div class="relinfo relconcepts">
    <h4 class="related">
     Related Concepts
    </h4>
    <ul>
     <li>
      <a class="link" href="../Functions_By_Functionality/String_Handling_Functions_Reference_AutoLISP.html">
       String-Handling Functions Reference (AutoLISP)
      </a>
     </li>
    </ul>
   </div>
   <div class="relinfo relref">
    <h4 class="related">
     Related Reference
    </h4>
    <ul>
     <li>
      <a class="link" href="vl_string_mismatch_AutoLISP.html" title="Returns the length of the longest common prefix for two strings, starting at specified positions">
       vl-string-mismatch (AutoLISP)
      </a>
     </li>
     <li>
      <a class="link" href="vl_string_position_AutoLISP.html" title="Looks for a character with the specified character code in a string">
       vl-string-position (AutoLISP)
      </a>
     </li>
     <li>
      <a class="link" href="vl_string_search_AutoLISP.html" title="Searches for the specified pattern in a string">
       vl-string-search (AutoLISP)
      </a>
     </li>
     <li>
      <a class="link" href="vl_string_translate_AutoLISP.html" title="Replaces characters in a string with a specified set of characters">
       vl-string-translate (AutoLISP)
      </a>
     </li>
    </ul>
   </div>
  </div>
 </body>
</html>
