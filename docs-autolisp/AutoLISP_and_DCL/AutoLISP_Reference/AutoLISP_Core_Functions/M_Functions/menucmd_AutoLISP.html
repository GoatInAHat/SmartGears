<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="reference-adsk" name="topic-type"/>
  <meta content="/view/OARX/2025/ENU/" name="helpsystempath"/>
  <meta content="OARX" name="product"/>
  <meta content="2025" name="release"/>
  <meta content="Developer" name="book"/>
  <meta content="AutoCAD-AutoLISP-Reference" name="component"/>
  <meta content="21/10/2024" name="created"/>
  <meta content="ACD=2025" name="applies-to"/>
  <meta content="ACAD_E=2025" name="applies-to"/>
  <meta content="AMECH_PP=2025" name="applies-to"/>
  <meta content="ARCHDESK=2025" name="applies-to"/>
  <meta content="BLDSYS=2025" name="applies-to"/>
  <meta content="CIV3D=2025" name="applies-to"/>
  <meta content="MAP=2025" name="applies-to"/>
  <meta content="PLNT3D=2025" name="applies-to"/>
  <meta content="PNID=2025" name="applies-to"/>
  <meta content="STRDET=2025" name="applies-to"/>
  <meta content="UTLDESN=2025" name="applies-to"/>
  <meta content="TRIDION" name="generatedby"/>
  <meta content="disable" name="user-comments"/>
  <meta content="Issues menu commands, or sets and retrieves menu item status" name="description"/>
  <meta content="MENUCMD" name="contextid"/>
  <meta content="general" name="experiencelevel"/>
  <meta content="programmer" name="audience"/>
  <meta content="29/03/2023" name="modified"/>
  <meta content="autolisp" name="topic-subtype"/>
  <meta content="function" name="topic-subtype"/>
  <meta content="GUID-20357966-71D4-4D55-881B-06AFDECD24DB" name="topicid"/>
  <meta content="ENU" name="language"/>
  <title>
   menucmd (AutoLISP)
  </title>
  <link href="../../../../_assets/client-28da4093.css" rel="stylesheet" type="text/css"/>
 </head>
 <body id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB">
  <div class="head">
   <div class="head-block">
    <div class="button-info">
     <span id="infoline">
     </span>
    </div>
    <div class="ancestry">
    </div>
    <div class="head-text">
     <h1>
      menucmd (AutoLISP)
     </h1>
    </div>
   </div>
  </div>
  <div class="body referencebody-adsk">
   <p class="shortdesc">
    Issues menu commands, or sets and retrieves menu item status
   </p>
   <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-E049A211-8422-4856-8878-401FA04484E5">
    <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-0A75B4A3-BD6D-4633-AB76-DE70E52BC48F">
     Supported Platforms:
    </strong>
    Windows, Mac OS, and Web
   </p>
   <div class="section" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-9D43190A-D0EE-4C2F-A4C5-724F845BD64A">
    <h2 class="title sectiontitle">
     Signature
    </h2>
    <pre class="pre codeblock prettyprint">(menucmd <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-CD297D20-BEAA-494C-BB01-9957E5145D78">str</em>)</pre>
    <div class="section" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WS1A9193826455F5FF-1E1423D1125831BDA67-7B34">
     <dl class="dl" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WS1A9193826455F5FF-1E1423D1125831BDA67-7B34">
      <dt class="dt dlterm">
       <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-46D5FD81-E55D-4A92-B2F3-A933200258F0">
        str
       </em>
      </dt>
      <dd class="dd" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-E53FAB75-6247-49A0-B8B6-78DE1FA40855">
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-AAFDE9FF-5339-4C05-A9C3-96E2BB5A4279">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-54992023-014D-45B0-A01B-353D9AE02C4C">
         Type:
        </strong>
        String
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3574">
        Menu area and the value to assign to that menu area. The
        <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-7C79A5D1-DFF0-4445-96CB-CF66C98C2929">
         string
        </em>
        argument has the following syntax:
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3573">
        <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-DB3B419A-3575-4E83-9825-9E9EA11F0C61">
         "menu_area=value"
        </samp>
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3572">
        The allowed values of
        <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-2981CC61-AC66-4E86-9EE4-57BD6368DA08">
         menu_area
        </em>
        , shown in the following list, are the same as they are in menu file submenu references.
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3571">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-986E6595-FEF8-4BDC-B370-F268553F22EC">
         B1-B4
        </strong>
        -- BUTTONS menus 1 through 4
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3570">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-5D9C2EAD-83F7-4B52-BDBF-523D977FC527">
         A1-A4
        </strong>
        -- AUX menus 1 through 4
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-356F">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-8ACA32E8-7E6F-45D4-BB0D-899BD28ED9AE">
         P0-P16
        </strong>
        -- Pull-down (POP) menus 0 through 16
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-356E">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-134D836C-759E-4445-8A2C-9A73A4A6031A">
         I
        </strong>
        -- Image tile menus
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-356D">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-5457C27F-0480-4E52-B237-13C323C6C86A">
         S
        </strong>
        -- SCREEN menu (Obsolete)
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-356C">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-8D244E49-987A-478A-A567-2677F8619731">
         T1-T4
        </strong>
        -- TABLET menus 1 through 4
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-356B">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-1086D8B9-4887-41EA-B934-F15F6D580C3F">
         M
        </strong>
        -- DIESEL string expressions
       </p>
       <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-356A">
        <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-6AA78068-8793-49CC-BA08-1AE067B1E561">
         <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-DF1FEBDE-C6F8-4BC8-A923-0E1E778D670A">
          Gmenugroup.nametag
         </em>
        </strong>
        -- A menugroup and name tag.
       </p>
       <div class="note note" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-3FA736AA-7458-49F6-AE19-02B0D34E71EB">
        <span class="notetitle">
         Note:
        </span>
        <ul class="ul" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__UL_D63551CEFEF74B6A8526794DA9B69A8A">
         <li class="li" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__LI_42DE6B8949B542098B2C11D04073417A">
          Only Pull-down (POP) menus and DIESEL string expressions are supported on Mac OS.
         </li>
         <li class="li" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__LI_2378A09847A647F3AFFC8BD47C577F09">
          Only DIESEL string expressions are supported on Web.
         </li>
        </ul>
       </div>
      </dd>
     </dl>
    </div>
   </div>
   <div class="section" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__SECTION_7C94F9F4CA5D430AB9E5AA280EA30A1F">
    <h2 class="title sectiontitle">
     Return Values
    </h2>
    <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-044D714D-5376-4D51-9B9C-4185237D4D01">
     <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-604A6626-0D2D-4950-ADFD-278B612F8A88">
      Type:
     </strong>
     nil
    </p>
    <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-3AFC3324-E727-4AC0-AD77-CA708A5B8564">
     Always returns
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-8F5D0DD3-005D-401E-A0FA-F447BAAE2B48">
      nil
     </samp>
     .
    </p>
   </div>
   <div class="section" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__SECTION_AEF8883ECEFF45D582AEFB445DB7D32B">
    <h2 class="title sectiontitle">
     Remarks
    </h2>
    <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3576">
     The
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-764A6A64-9835-4D9A-AE44-71AAC8647FC7">
      menucmd
     </samp>
     function can switch between subpages in an AutoCAD menu. This function can also force the display of menus. This allows AutoLISP programs to use image tile menus and to display other menus from which the user can make selections. AutoLISP programs can also enable, disable, and place marks in menu or ribbon items.
    </p>
   </div>
   <div class="section" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__SECTION_AA65154F2C05474CB1BABC2C9E56F537">
    <h2 class="title sectiontitle">
     Examples
    </h2>
    <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3566">
     The following code displays the image tile menu
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-6F037229-F5D4-4646-BF6F-A8001133481C">
      MOREICONS
     </samp>
     :
    </p>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-8F5CF453-4C6E-4FDB-9032-04A956B50FB5">(menucmd "I=moreicons")</strong>       <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-AC189A31-BA83-4AD2-8343-5B3E4657CB8E">Loads the MOREICONS image tile menu</em>
<strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-B69AE6F7-9232-4C29-805C-BFE87C29475F">(menucmd "I=*")</strong>               <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-2C93FE38-3045-490B-8683-9EB6966CA192">Displays the menu</em></pre>
    <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3565">
     The following code checks the status of the third menu item in the pull-down menu
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-5BFEDB07-8F97-465E-9F6C-6DB9809B7760">
      POP11
     </samp>
     . If the menu item is currently enabled, the
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-F3EFB41A-422B-4F2E-88B4-2DC575A5EC81">
      <strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-E9F12BE6-B00B-4762-872D-07F17B775DF1">
       menucmd
      </strong>
     </samp>
     function disables it.
    </p>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-658600CA-DCD9-4F91-A41D-D0C385670C55">(setq s (menucmd "P11.3=?"))</strong>  <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-CD2504F5-36EF-4C2A-99F1-DEA8C8D22715">Gets the status of the menu item</em>
<strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-1FE677E1-01BD-4C11-B71C-C11BB58D2031">(if (= s "")</strong>                  <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-6F8C6D97-C7E3-4407-BFA4-3548FC393478">If the status is an empty string,</em>
<strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-793D4509-4ACE-4381-9AAC-36ED78AA31EC">  (menucmd "P11.3=~")</strong>         <em class="ph i" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-64719565-2234-4AB1-88FA-6AC33B41D059">disable the menu item</em>
<strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-37899898-125D-4366-8F3A-537D1BD5B215">)</strong></pre>
    <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3564">
     The previous code is not foolproof. In addition to being enabled or disabled, menu items can also receive marks. The code
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-D16A42FB-D337-4E8D-8939-83166F2FDCC0">
      (menucmd "P11.3=?")
     </samp>
     could return
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-BE41316C-5AA1-4D4D-A933-D7B93CE48AFB">
      "!."
     </samp>
     , indicating that the menu item is currently checked. This code would assume that the menu item is disabled and continue without disabling it. If the code included a call to the
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-74C705CB-AE2F-44B1-BC63-D6D4B2697D95">
      wcmatch
     </samp>
     function, it could check the status for an occurrence of the tilde (
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-8E2D8730-DF92-4D11-B71E-66612662ADFB">
      ~)
     </samp>
     character and then take appropriate action.
    </p>
    <p class="p" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__WSFACF1429558A55DE11F0759FF1E4B858C-3563">
     The
     <samp class="ph codeph" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-D33CDCEC-7E3F-4C9D-AFF3-DAD0E998BC1C">
      menucmd
     </samp>
     function also allows AutoLISP programs to take advantage of the DIESEL string expression language. Some things can be done more easily with DIESEL than with the equivalent AutoLISP code. The following code returns a string containing the current day and date:
    </p>
    <pre class="pre codeblock prettyprint"><strong class="ph b" id="GUID-20357966-71D4-4D55-881B-06AFDECD24DB__GUID-B3A06F5D-D196-4213-A985-6A89A86B4AB5">(menucmd "M=$(edtime,$(getvar,date),DDDD\",\" D MONTH YYYY)")</strong>
"Sunday, 16 July 1995"</pre>
   </div>
  </div>
  <div class="related-links">
   <div class="relinfo relconcepts">
    <h4 class="related">
     Related Concepts
    </h4>
    <ul>
     <li>
      <a class="link" href="../Functions_By_Functionality/Display_Control_Functions_Reference_AutoLISP.html">
       Display Control Functions Reference (AutoLISP)
      </a>
     </li>
    </ul>
   </div>
   <div class="relinfo relref">
    <h4 class="related">
     Related Reference
    </h4>
    <ul>
     <li>
      <a class="link" href="menugroup_AutoLISP.html" title="Verifies that a menugroup is loaded">
       menugroup (AutoLISP)
      </a>
     </li>
    </ul>
   </div>
  </div>
 </body>
</html>
